<!DOCTYPE html>
<html>
<head>
    <title>Scientific Calculator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
            * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body, html {
            height: 100%;
            width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            overflow: hidden;
            touch-action: manipulation;
            background-color: #f0f0f0;
        }
        
        #app-container {
            display: flex;
            height: 100%;
            width: 100vw;
            position: relative;
        }
        
        #calculator {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            padding: 15px;
            background-color: #333;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        #display {
            background-color: #222;
            color: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            text-align: right;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            flex-shrink: 0;
        }
        
        .display-line {
            height: 25px;
            font-size: 18px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .display-line.current {
            font-size: 24px;
            height: 30px;
            color: #4CAF50;
        }
        
        .display-line.result {
            font-size: 28px;
            height: 35px;
            font-weight: bold;
        }
        
        .buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            flex-grow: 1;
            min-height: 0;
        }
        
        button {
            height: 100%;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #555;
            color: white;
            transition: all 0.2s;
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }
        
        button:hover {
            filter: brightness(1.2);
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        button.operation {
            background-color: #ff9500;
        }
        
        button.scientific {
            background-color: #4CAF50;
        }
        
        button.equals {
            background-color: #2196F3;
        }
        
        button.clear {
            background-color: #f44336;
        }
        
        button.function {
            background-color: #9C27B0;
        }
        
        button.history {
            background-color: #607D8B;
        }
        
        #history-panel {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 100%;
            max-width: 400px;
            padding: 15px;
            background-color: white;
            border-left: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 10;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
        }
        
        #history-panel.visible {
            transform: translateX(0);
        }
        
        #history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        #history-list {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .history-item {
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
        }
        
        .history-item:hover {
            background-color: #f5f5f5;
        }
        
        .history-expression {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 3px;
        }
        
        .history-result {
            color: #2196F3;
            font-size: 1.2em;
        }
        
        .history-timestamp {
            color: #777;
            font-size: 0.8em;
            margin-top: 3px;
        }
        
        #history-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        #clear-history {
            padding: 8px 15px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        #close-history {
            padding: 8px 15px;
            background-color: #9C27B0;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        #install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 100;
            display: none;
        }
        
        @media (max-width: 500px) {
            #calculator {
                border-radius: 0;
                max-width: 100%;
            }
        }
        
            .vibration-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #4CAF50;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        #install-app-btn {
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }
        
        #install-app-btn.installed {
            background-color: #777;
            cursor: default;
        }
        
        #history-controls {
            display: flex;
            flex-direction: column; /* Changed to column layout */
            margin-top: 10px;
            gap: 10px;
        }
        
    </style>
</head>
<body>
    <div id="app-container">
        <div id="calculator">
  <span style="font-size: 45px; padding-top: 0; margin-bottom: 0.5px; text-align: center; background: linear-gradient(to right, #ff8a00, #e52e71); -webkit-background-clip: text; background-clip: text; color: transparent; font-weight: bold; text-shadow: 0 4px 6px rgba(0,0,0,0.5);" class="logo-text">üßÆCALC-‚ùå</span>
            <div id="display">
                <div class="display-line" id="last-calculation"></div>
                <div class="display-line" id="last-result"></div>
                <div class="display-line current" id="current-calculation"></div>
                <div class="display-line result" id="current-result"></div>
            </div>
            
            <div class="buttons">
                <!-- Row 1 -->
                <button class="scientific calc-btn" data-value="Math.pow(10,">2nd</button>
                <button class="scientific calc-btn" data-value="deg">DEG</button>
                <button class="function calc-btn" data-value="sin">sin</button>
                <button class="function calc-btn" data-value="cos">cos</button>
                <button class="function calc-btn" data-value="tan">tan</button>
                
                <!-- Row 2 -->
                <button class="scientific calc-btn" data-value="Math.pow(">x^y</button>
                <button class="scientific calc-btn" data-value="Math.log10(">log</button>
                <button class="scientific calc-btn" data-value="Math.log(">ln</button>
                <button class="calc-btn" data-value="(">(</button>
                <button class="calc-btn" data-value=")">)</button>
                
                <!-- Row 3 -->
                <button class="scientific calc-btn" data-value="Math.sqrt(">‚àöx</button>
                <button class="clear calc-btn" data-value="clear">ClrScrn</button>
                <button class="scientific calc-btn" data-value="backspace">‚å´</button>
                <button class="calc-btn" data-value="%">%</button>
                <button class="operation calc-btn" data-value="/">/</button>
                
                <!-- Row 4 -->
                <button class="scientific calc-btn" data-value="1/">1/x</button>
                <button class="calc-btn" data-value="7">7</button>
                <button class="calc-btn" data-value="8">8</button>
                <button class="calc-btn" data-value="9">9</button>
                <button class="operation calc-btn" data-value="*">√ó</button>
                
                <!-- Row 5 -->
                <button class="scientific calc-btn" data-value="Math.PI">œÄ</button>
                <button class="calc-btn" data-value="4">4</button>
                <button class="calc-btn" data-value="5">5</button>
                <button class="calc-btn" data-value="6">6</button>
                <button class="operation calc-btn" data-value="-">-</button>
                
                <!-- Row 6 -->
                <button class="scientific calc-btn" data-value="Math.E">e</button>
                <button class="calc-btn" data-value="1">1</button>
                <button class="calc-btn" data-value="2">2</button>
                <button class="calc-btn" data-value="3">3</button>
                <button class="operation calc-btn" data-value="+">+</button>
                
                <!-- Row 7 -->
                <button class="scientific calc-btn" data-value="Math.exp(">e^x</button>
                <button class="history calc-btn" data-value="history">HIST</button>
                <button class="calc-btn" data-value="0">0</button>
                <button class="calc-btn" data-value=".">.</button>
                <button class="equals calc-btn" data-value="=">=</button>
            </div>
        </div>

       <div id="history-panel">
        <div id="history-header">
            <h3>Calculation History</h3>
        </div>
        
        <div class="vibration-toggle">
            <span>Haptic Feedback</span>
            <label class="switch">
                <input type="checkbox" id="vibration-toggle" checked>
                <span class="slider"></span>
            </label>
        </div>
        
        <div id="history-list"></div>
        <div id="history-controls">
            <button id="install-app-btn">Install App</button>
            <button onclick="clearHistory()" id="clear-history">Clear History</button>
            <button onclick="toggleHistory()" id="close-history">Close</button>
            
            <p style="color: #000000d9; font-size: 7px; margin-top: 15px; margin-bottom: 0; text-align: center;">&copy; 2025, CRE8IVE_pixelz. All rights reserved.</p>
        </div>        
    </div>

    <script>
        // Global variables
        let currentCalculation = '';
        let lastCalculation = '';
        let lastResult = '';
        let isDegreeMode = true;
        let isNewCalculation = true;
        let calculationHistory = JSON.parse(localStorage.getItem('calculatorHistory')) || [];
        let hapticEnabled = true;
        let deferredPrompt;

        // Initialize calculator
        document.addEventListener('DOMContentLoaded', () => {
            // Set up button event listeners
            document.querySelectorAll('.calc-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    triggerHapticFeedback();
                    const value = btn.getAttribute('data-value');
                    
                    switch(value) {
                        case 'clear':
                            clearDisplay();
                            break;
                        case 'backspace':
                            backspace();
                            break;
                        case '=':
                            calculate();
                            break;
                        case 'history':
                            toggleHistory();
                            break;
                        case 'deg':
                            toggleDegreeMode();
                            break;
                        case 'sin':
                        case 'cos':
                        case 'tan':
                            trigFunction(value);
                            break;
                        case 'Math.PI':
                        case 'Math.E':
                            appendToDisplay(value);
                            break;
                        case 'Math.sqrt(':
                        case 'Math.log(':
                        case 'Math.log10(':
                        case 'Math.pow(':
                        case 'Math.exp(':
                        case '1/':
                            addFunction(value);
                            break;
                        default:
                            appendToDisplay(value);
                    }
                });
            });

            // Initialize vibration toggle
            const vibrationToggle = document.getElementById('vibration-toggle');
            if (vibrationToggle) {
                vibrationToggle.checked = localStorage.getItem('hapticEnabled') !== 'false';
                hapticEnabled = vibrationToggle.checked;
                vibrationToggle.addEventListener('change', function() {
                    hapticEnabled = this.checked;
                    localStorage.setItem('hapticEnabled', this.checked);
                });
            }

            // Modified PWA installation code
        let deferredPrompt;
        
        // Update the install button state
        function updateInstallButton() {
            const installBtn = document.getElementById('install-app-btn');
            if (window.matchMedia('(display-mode: standalone)').matches) {
                installBtn.textContent = 'Already Installed';
                installBtn.classList.add('installed');
                installBtn.disabled = true;
            } else if (deferredPrompt) {
                installBtn.textContent = 'Install App';
                installBtn.classList.remove('installed');
                installBtn.disabled = false;
            } else {
                installBtn.textContent = 'Install Not Available';
                installBtn.classList.add('installed');
                installBtn.disabled = true;
            }
        }
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            updateInstallButton();
        });
        
        document.getElementById('install-app-btn').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User response: ${outcome}`);
                deferredPrompt = null;
                updateInstallButton();
            }
        });
        
        // Check installation status on load
        window.addEventListener('load', updateInstallButton);
        
        // Also check when history panel is opened
        function toggleHistory() {
            const historyPanel = document.getElementById('history-panel');
            historyPanel.classList.toggle('visible');
            if (historyPanel.classList.contains('visible')) {
                updateInstallButton();
            }
        }

            updateDisplay();
            updateHistoryDisplay();
        });

        // Calculator functions
        function appendToDisplay(value) {
            if (isNewCalculation && !isNaN(value)) {
                currentCalculation = '';
                isNewCalculation = false;
            }
            
            if (value === 'Math.PI') {
                currentCalculation += Math.PI;
            } else if (value === 'Math.E') {
                currentCalculation += Math.E;
            } else {
                currentCalculation += value;
            }
            
            updateDisplay();
        }

        function backspace() {
            currentCalculation = currentCalculation.slice(0, -1);
            updateDisplay();
        }

        function clearDisplay() {
            currentCalculation = '';
            isNewCalculation = true;
            updateDisplay();
        }

        function toggleDegreeMode() {
            isDegreeMode = !isDegreeMode;
            document.querySelector('.calc-btn[data-value="deg"]').textContent = isDegreeMode ? 'DEG' : 'RAD';
        }

        function addFunction(func) {
            if (func === '1/') {
                currentCalculation = `1/(${currentCalculation})`;
            } else {
                currentCalculation = func + currentCalculation + (func.includes('(') ? ')' : '');
            }
            updateDisplay();
        }

        function trigFunction(func) {
            let value = currentCalculation || '0';
            let angle = parseFloat(value);
            
            if (isDegreeMode) {
                angle = angle * Math.PI / 180;
            }
            
            let result;
            switch(func) {
                case 'sin': result = Math.sin(angle); break;
                case 'cos': result = Math.cos(angle); break;
                case 'tan': result = Math.tan(angle); break;
            }
            
            result = parseFloat(result.toFixed(10));
            
            calculationHistory.unshift({
                expression: `${func}(${value}${isDegreeMode ? '¬∞' : 'rad'})`,
                result: result,
                timestamp: new Date().toLocaleString()
            });
            localStorage.setItem('calculatorHistory', JSON.stringify(calculationHistory));
            
            lastCalculation = `${func}(${value}${isDegreeMode ? '¬∞' : 'rad'})`;
            lastResult = result.toString();
            currentCalculation = result.toString();
            isNewCalculation = true;
            
            updateDisplay();
            document.getElementById('current-result').textContent = '= ' + result;
            updateHistoryDisplay();
        }

        function calculate() {
            try {
                if (!currentCalculation) return;
                
                let expression = currentCalculation
                    .replace(/√ó/g, '*')
                    .replace(/√∑/g, '/');
                
                const result = eval(expression);
                
                calculationHistory.unshift({
                    expression: currentCalculation,
                    result: result,
                    timestamp: new Date().toLocaleString()
                });
                localStorage.setItem('calculatorHistory', JSON.stringify(calculationHistory));
                
                lastCalculation = currentCalculation;
                lastResult = result.toString();
                document.getElementById('current-result').textContent = '= ' + result;
                
                currentCalculation = result.toString();
                isNewCalculation = true;
                
                updateHistoryDisplay();
                
            } catch (error) {
                document.getElementById('current-result').textContent = 'Error';
            }
        }

        function updateDisplay() {
            document.getElementById('last-calculation').textContent = lastCalculation || ' ';
            document.getElementById('last-result').textContent = lastResult ? '= ' + lastResult : ' ';
            document.getElementById('current-calculation').textContent = currentCalculation || '0';
        }

        // History panel functions
        function toggleHistory() {
            const historyPanel = document.getElementById('history-panel');
            historyPanel.classList.toggle('visible');
        }

        function updateHistoryDisplay() {
            const historyList = document.getElementById('history-list');
            historyList.innerHTML = '';
            
            if (calculationHistory.length === 0) {
                historyList.innerHTML = '<div style="padding: 20px; text-align: center; color: #777;">No history yet</div>';
                return;
            }
            
            calculationHistory.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div class="history-expression">${item.expression}</div>
                    <div class="history-result">= ${item.result}</div>
                    <div class="history-timestamp">${item.timestamp}</div>
                `;
                historyItem.onclick = () => {
                    currentCalculation = item.expression.includes('=') ? 
                        item.expression.split('=')[0].trim() : 
                        item.expression;
                    isNewCalculation = false;
                    document.getElementById('history-panel').classList.remove('visible');
                    updateDisplay();
                };
                historyList.appendChild(historyItem);
            });
        }

        function clearHistory() {
            if (confirm('Are you sure you want to clear all history?')) {
                calculationHistory = [];
                localStorage.removeItem('calculatorHistory');
                updateHistoryDisplay();
            }
        }

        // Haptic feedback function
        function triggerHapticFeedback() {
            if (!hapticEnabled) return;
            
            if (window.AudioContext || window.webkitAudioContext) {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    oscillator.type = 'sine';
                    oscillator.frequency.value = 150;
                    oscillator.connect(audioContext.destination);
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.005);
                } catch (e) {
                    console.log("Audio context error:", e);
                }
            }
            else if ('vibrate' in navigator) {
                try {
                    navigator.vibrate(5);
                } catch (e) {
                    console.log("Vibration error:", e);
                }
            }
        }

        // Prevent keyboard on mobile
        document.addEventListener('touchstart', function(e) {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                e.preventDefault();
            }
        }, { passive: false });
        
        
    </script>
</body>
</html>
                           
                                
